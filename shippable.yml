language: node_js

node_js:
  - 0.10.33
  
env:
  global:
    - APP_NAME=arctic-canoe-5436
    - XUNIT_FILE=./shippable/testresults/result.xml
    
before_install:
  - npm install -g grunt-cli
  - mkdir -p ./shippable/testresults
  - mkdir -p ./shippable/codecoverage

install:
    - npm install

script:
    - grunt

after_success:
    - ./node_modules/.bin/istanbul cover grunt -- -u tdd
    - ./node_modules/.bin/istanbul report cobertura --dir  ./shippable/codecoverage/
    - git push -f git@heroku.com:$APP_NAME.git master
